NEW
10 REM  - /HOME/BILL/GIT/SETDATE/DATETIME.BAS - 02/02/2019 - 08h12
20 REM *******************
30 REM DATE & TIME SETTING
40 REM *******************
50 GOTO 1040
60 REM->DRAWSCREEN
70 HTAB BX
80 VTAB BY
90 PRINT
100 PRINT "           SYSTEM DATE & TIME"
110 PRINT
120 PRINT
130 PRINT
140 HTAB BX
150 PRINT "              DAY MONTH YEAR"
160 PRINT
170 HTAB BX
180 PRINT "        DATE: ";
190 INVERSE : PRINT DAY$;  : NORMAL
200 PRINT " - ";
210 INVERSE : PRINT MNTH$; : NORMAL
220 PRINT " - ";
230 INVERSE : PRINT YEAR$  : NORMAL
240 PRINT
250 PRINT
260 HTAB BX
270 PRINT "             HOUR MIN MERIDIEM"
280 PRINT
290 HTAB BX
300 PRINT "        TIME: ";HOUR$;" : ";MINUTE$;"   ";AMPM$;"M"
310 PRINT
320 PRINT
330 PRINT
340 PRINT "        TAB - SKIP TO NEXT FIELD"
350 PRINT "     RETURN - ACCEPT ENTERED VALUES"
360 PRINT "        ESC - CANCEL"
370 RETURN
380 REM->FORMATDATEANDTIME
390 LET YEAR$ = STR$(YEAR)
400 IF LEN(YEAR$) = 1 THEN LET YEAR$ = "0" + YEAR$
410 LET MNTH$ = MNTHS$(MNTH)
420 LET DAY$ = STR$(DAY)
430 IF LEN(DAY$) = 1 THEN LET DAY$ = "0" + DAY$
440 LET HOUR$ = STR$(HOUR)
450 IF LEN(HOUR$) = 1 THEN LET HOUR$ = "0" + HOUR$
460 LET MINUTE$ = STR$(MINUTE)
470 IF LEN(MINUTE$) = 1 THEN LET MINUTE$ = "0" + MINUTE$
480 RETURN
490 REM->GETSYSTEMDATE
500 LET DH = PEEK(49041): REM DATE HIGH BYTE
510 LET DL = PEEK(49040): REM DATE LOW BYTE
520 LET TH = PEEK(49043): REM TIME HIGH BYTE
530 LET TL = PEEK(49042): REM TIME LOW BYTE 
540 LET YEAR = INT (DH / 2)
550 LET MNTH = ((DH/2 - INT(DH/2)) > 0) * 2 ^ 3 +  INT (DL / 32)
560 LET DAY = DL
570 IF DAY >= 128 THEN DAY = DAY - 128
580 IF DAY >= 64  THEN DAY = DAY - 64
590 IF DAY >= 32  THEN DAY = DAY - 32
600 IF TH = 0  THEN HOUR = 12      : AMPM$ = "A"
610 IF TH = 12 THEN HOUR = 12      : AMPM$ = "P"
620 IF TH > 12 THEN HOUR = TH - 12 : AMPM$ = "P"
630 IF TH < 12 THEN HOUR = TH      : AMPM$ = "A"
640 LET MINUTE = TL
650 RETURN 
660 REM->SETSYSTEMDATEANDTIME
670 IF YEAR >= 100 THEN Y2 = VAL(RIGHT$(STR$(YEAR),2))
680 IF YEAR <  100 THEN Y2 = YEAR
690 LET DH = Y2 * 2 + (MNTH >  = 8)
700 LET DL = MNTH * 32 - 128 * (MNTH >  = 8) + DAY
710 IF HOUR =  12 AND AMPM$ = "A" THEN TH = 0
720 IF HOUR =  12 AND AMPM$ = "P" THEN TH = 12
730 IF HOUR <> 12 AND AMPM$ = "P" THEN TH = HOUR + 12
740 IF HOUR <> 12 AND AMPM$ = "A" THEN TH = HOUR
750 LET TL = MINUTE
760 POKE 49041,DH: REM DATE HIGH BYTE
770 POKE 49040,DL: REM DATE LOW BYTE
780 POKE 49043,TH: REM TIME HIGH BYTE
790 POKE 49042,TL: REM TIME LOW BYTE
800 RETURN 
810 REM->DAYDIGITONE
820 HTAB 15 : VTAB 10
830 GET K$
840 IF "0" <= K$ AND K$ <= "3" THEN PRINT K$; : GOTO 900
850 IF K$ = T$ THEN GOTO 1000
860 IF K$ = RT$ THEN GOTO 900
870 PRINT BEEP$
880 GOTO 820
890 REM->DAYDIGITTWO
900 HTAB 16 : VTAB 10
910 GET K$
920 IF "0" <= K$ AND K$ <= "9" THEN PRINT K$; : GOTO 1000
930 IF K$ = T$ THEN GOTO 1000
940 IF K$ = RT$ THEN GOTO 1000
950 IF K$ = LT$ THEN GOTO 820
960 IF K$ = DLT$ THEN GOTO 820
970 PRINT BEEP$
980 GOTO 900
990 REM->MONTHCHARONE
1000 HTAB 20 : VTAB 10
1010 GET K$
1020 END
1030 REM->MAIN
1040 HOME
1050 DIM MNTHS$(12)
1060 FOR I = 1 TO 12
1070 READ MNTHS$(I)
1080 NEXT
1090 LET RT$=CHR$(21)
1100 LET LT$=CHR$(8)
1110 LET ESC$=CHR$(27)
1120 LET DLT$=CHR$(127)
1130 LET BEEP$=CHR$(7)
1140 LET T$=CHR$(9)
1150 LET BX=1
1160 LET BY=3
1170 GOSUB 500
1180 GOSUB 390
1190 GOSUB 70
1200 GOTO 820
1210 END
1220 DATA JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
RUN
