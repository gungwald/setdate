10 REM DATEENTRYFORM.BAS - 17/02/2019 - 06h53
20 REM ***********************
30 REM PROGRAM: DATEENTRYFORM
40 REM SYSTEM:  PRODOS
50 REM AUTHOR:  BILL CHATFIELD
60 REM LICENSE: GPL3
70 REM ***********************
80 LET D$=CHR$(4)
90 LET LT$=CHR$(8)
100 LET DOWN$=CHR$(10)
110 LET UP$=CHR$(11)
120 LET RET$=CHR$(13)
130 LET D1$=CHR$(17) 
140 LET D2$=CHR$(18) 
150 LET NAK$=CHR$(21)   
160 LET RT$=CHR$(21)
170 LET ESC$=CHR$(27)
180 LET DLT$=CHR$(127)
190 LET BEEP$=CHR$(7)
200 LET TB$=CHR$(9)
210 LET BX=1
220 LET BY=2
230 DIM MNTHS$(12), MDAYS(12)
240 FOR I = 1 TO 12
250 READ MNTHS$(I), MDAYS(I)
260 NEXT
270 DATA JAN,31
280 DATA FEB,29
290 DATA MAR,31
300 DATA APR,30
310 DATA MAY,31
320 DATA JUN,30
330 DATA JUL,31
340 DATA AUG,31
350 DATA SEP,30
360 DATA OCT,31
370 DATA NOV,30
380 DATA DEC,31
390 PRINT D$;"PR#3" : REM TURN ON 80-COLUMN CARD
400 PRINT D1$       : REM SWITCH TO 40 COLUMNS FOR MOUSE CHARS
410 GOSUB 1290:REM GO->GETSYSTEMDATE 
420 GOSUB 1040:REM GO->FORMATDATEANDTIME 
430 GOSUB 540:REM GO->DRAWSCREEN 
440 GOSUB 1640:REM GO->ENTERDATEANDTIME 
450 GOSUB 1230:REM GO->DECODEDATEANDTIME 
460 GOSUB 1460:REM GO->SETSYSTEMDATEANDTIME 
470 PRINT NAK$ : REM TURN OFF 80-COL CARD
480 HOME
490 PRINT
500 IF K$ = RET$ THEN PRINT "SET SYSTEM DATE: "; : GOSUB 3810 : END:REM GO->PRINTDATE 
510 PRINT "CANCELLED SETTING OF DATE AND TIME."
520 END
530 REM->DRAWSCREEN
540 HTAB BX : VTAB BY
550 PRINT "         SET SYSTEM DATE & TIME"
560 PRINT
570 PRINT
580 PRINT
590 PRINT
600 HTAB BX
610 PRINT "             DAY  MONTH YEAR"
620 PRINT
630 HTAB BX
640 PRINT "        DATE: ";DAY$;" - ";MNTH$;" - ";YEAR$ 
650 PRINT
660 PRINT
670 HTAB BX
680 PRINT "             HOUR MIN MERIDIEM"
690 PRINT
700 HTAB BX
710 PRINT "        TIME: ";HOUR$;" : ";MINUTE$;"  ";AMPM$;"M"
720 PRINT
730 PRINT
740 PRINT
750 PRINT
760 HTAB BX
770 PRINT " RETURN - ACCEPT   "; : GOSUB 900 : PRINT "-D - GOTO YEAR":REM GO->PRINTOPENAPPLE 
780 HTAB BX
790 PRINT "    ESC - CANCEL   "; : GOSUB 900 : PRINT "-M - GOTO MONTH":REM GO->PRINTOPENAPPLE 
800 HTAB BX
810 PRINT "    TAB - NXT FLD  "; : GOSUB 900 : PRINT "-Y - GOTO YEAR":REM GO->PRINTOPENAPPLE 
820 HTAB BX
830 PRINT "   "; : GOSUB 950 : PRINT " - MOVE     "; : GOSUB 900 : PRINT "-H - GOTO HOUR":REM GO->PRINTARROWS PRINTOPENAPPLE 
840 HTAB BX
850 PRINT "      + - INC VAL  "; : GOSUB 900 : PRINT "-N - GOTO MINUTE":REM GO->PRINTOPENAPPLE 
860 HTAB BX
870 PRINT "      - - DEC VAL  "; : GOSUB 900 : PRINT "-R - GOTO MERIDIEM";:REM GO->PRINTOPENAPPLE 
880 RETURN
890 REM->PRINTOPENAPPLE
900 INVERSE
910 PRINT CHR$(27);"A";CHR$(24);
920 NORMAL
930 RETURN
940 REM->PRINTARROWS
950 INVERSE
960 PRINT CHR$(27);"HJKU";CHR$(24);
970 NORMAL
980 RETURN
990 REM->FORMATMONTH 
1000 LET MNTH$ = MNTHS$(MNTH)
1010 IF MNTH$ = "" THEN LET MNTH$ = "JAN" : LET MNTH = 1
1020 RETURN 
1030 REM->FORMATDATEANDTIME
1040 LET YEAR$ = STR$(YEAR)
1050 IF LEN(YEAR$) = 1 THEN LET YEAR$ = "0" + YEAR$
1060 GOSUB 1000:REM GO->FORMATMONTH 
1070 LET DAY$ = STR$(DAY)
1080 IF LEN(DAY$) = 1 THEN LET DAY$ = "0" + DAY$
1090 LET HOUR$ = STR$(HOUR)
1100 IF LEN(HOUR$) = 1 THEN LET HOUR$ = "0" + HOUR$
1110 LET MINUTE$ = STR$(MINUTE)
1120 IF LEN(MINUTE$) = 1 THEN LET MINUTE$ = "0" + MINUTE$
1130 RETURN
1140 REM->DECODEMONTH
1150 FOR I = 1 TO 12
1160 IF MNTHS$(I) = MNTH$ THEN MNTH = I : RETURN
1170 NEXT
1180 VTAB 24
1190 PRINT
1200 PRINT "INVALID MONTH NAME: " + MNTH$
1210 END
1220 REM->DECODEDATEANDTIME
1230 LET YEAR = VAL(YEAR$)
1240 GOSUB 1150:REM GO->DECODEMONTH 
1250 LET HOUR = VAL(HOUR$)
1260 LET MINUTE = VAL(MINUTE$)
1270 RETURN
1280 REM->GETSYSTEMDATE
1290 LET DH = PEEK(49041): REM DATE HIGH BYTE
1300 LET DL = PEEK(49040): REM DATE LOW BYTE
1310 LET TH = PEEK(49043): REM TIME HIGH BYTE
1320 LET TL = PEEK(49042): REM TIME LOW BYTE 
1330 LET YEAR = INT (DH / 2)
1340 LET MNTH = ((DH/2 - INT(DH/2)) > 0) * 2 ^ 3 +  INT (DL / 32)
1350 LET DAY = DL
1360 IF DAY >= 128 THEN DAY = DAY - 128
1370 IF DAY >= 64  THEN DAY = DAY - 64
1380 IF DAY >= 32  THEN DAY = DAY - 32
1390 IF TH = 0  THEN HOUR = 12      : AMPM$ = "A"
1400 IF TH = 12 THEN HOUR = 12      : AMPM$ = "P"
1410 IF TH > 12 THEN HOUR = TH - 12 : AMPM$ = "P"
1420 IF 0 < TH AND TH < 12 THEN HOUR = TH      : AMPM$ = "A"
1430 LET MINUTE = TL
1440 RETURN 
1450 REM->SETSYSTEMDATEANDTIME
1460 IF YEAR >= 100 THEN Y2 = VAL(RIGHT$(STR$(YEAR),2))
1470 IF YEAR <  100 THEN Y2 = YEAR
1480 LET DH = Y2 * 2 + (MNTH >  = 8)
1490 LET DL = MNTH * 32 - 128 * (MNTH >  = 8) + DAY
1500 IF HOUR =  12 AND AMPM$ = "A" THEN TH = 0
1510 IF HOUR =  12 AND AMPM$ = "P" THEN TH = 12
1520 IF HOUR <> 12 AND AMPM$ = "P" THEN TH = HOUR + 12
1530 IF HOUR <> 12 AND AMPM$ = "A" THEN TH = HOUR
1540 LET TL = MINUTE
1550 POKE 49041,DH: REM DATE HIGH BYTE
1560 POKE 49040,DL: REM DATE LOW BYTE
1570 POKE 49043,TH: REM TIME HIGH BYTE
1580 POKE 49042,TL: REM TIME LOW BYTE
1590 RETURN 
1600 REM->SOUNDERROR
1610 PRINT BEEP$
1620 RETURN
1630 REM->ENTERDATEANDTIME
1640 REM->DAYDIGITONE
1650 HTAB 15 : VTAB 9
1660 GET K$
1670 IF "0" <= K$ AND K$ <= "3" THEN PRINT K$; : DAY$ = K$ + RIGHT$(DAY$, 1) : GOTO 1800:REM GO->DAYDIGITTWO 
1680 IF K$ = " "             THEN GOTO 1800:REM GO->DAYDIGITTWO 
1690 IF K$ = TB$        THEN GOTO 2000:REM GO->MONTHCHARONE 
1700 IF K$ = RT$ THEN GOTO 1800:REM GO->DAYDIGITTWO 
1710 IF K$ = LT$  THEN GOTO 3660:REM GO->MERIDIEM 
1720 IF K$ = DOWN$ THEN GOTO 2960:REM GO->HOURDIGITONE 
1730 IF K$ = "+"             THEN GOSUB 3950 : PRINT DAY$; : GOTO 1650:REM GO->INCDAY DAYDIGITONE 
1740 IF K$ = "-"             THEN GOSUB 4030 : PRINT DAY$; : GOTO 1650:REM GO->DECDAY DAYDIGITONE 
1750 IF K$ = DLT$ THEN GOTO 3660:REM GO->MERIDIEM 
1760 GOSUB 4730:REM GO->JUMPKEYS 
1770 GOSUB 1610:REM GO->SOUNDERROR 
1780 GOTO 1650:REM GO->DAYDIGITONE 
1790 REM->DAYDIGITTWO
1800 HTAB 16 : VTAB 9
1810 GET K$
1820 IF K$ < "0" OR "9" < K$ THEN GOTO 1880:REM GO->DAYDIGITTWOKEYS 
1830 LET FIRST$ = LEFT$(DAY$, 1)
1840 LET TEST$ = FIRST$ + K$
1850 LET TV = VAL(TEST$)
1860 IF 1 <= TV AND TV <= MDAYS(MNTH) THEN PRINT K$; : DAY$ = TEST$ : DAY = TV : GOTO 2000:REM GO->MONTHCHARONE 
1870 REM->DAYDIGITTWOKEYS
1880 IF K$ = " "             THEN GOTO 2000:REM GO->MONTHCHARONE 
1890 IF K$ = TB$        THEN GOTO 2000:REM GO->MONTHCHARONE 
1900 IF K$ = RT$ THEN GOTO 2000:REM GO->MONTHCHARONE 
1910 IF K$ = LT$  THEN GOTO 1650:REM GO->DAYDIGITONE 
1920 IF K$ = DOWN$ THEN GOTO 2960:REM GO->HOURDIGITONE 
1930 IF K$ = "+"             THEN GOSUB 3950 : PRINT LT$;DAY$; : GOTO 1800:REM GO->INCDAY DAYDIGITTWO 
1940 IF K$ = "-"             THEN GOSUB 4030 : PRINT LT$;DAY$; : GOTO 1800:REM GO->DECDAY DAYDIGITTWO 
1950 IF K$ = DLT$ THEN GOTO 1650:REM GO->DAYDIGITONE 
1960 GOSUB 4730:REM GO->JUMPKEYS 
1970 GOSUB 1610:REM GO->SOUNDERROR 
1980 GOTO 1800:REM GO->DAYDIGITTWO 
1990 REM->MONTHCHARONE
2000 HTAB 20 : VTAB 9
2010 GET K$
2020 IF K$ = LEFT$(MNTH$, 1) THEN GOTO 2230:REM GO->MONTHCHARTWO 
2030 IF K$ = "J" THEN MNTH$ = "JAN" : MNTH=1  : PRINT MNTH$; : GOTO 2230:REM GO->MONTHCHARTWO 
2040 IF K$ = "F" THEN MNTH$ = "FEB" : MNTH=2  : PRINT MNTH$; : GOTO 2230:REM GO->MONTHCHARTWO 
2050 IF K$ = "M" THEN MNTH$ = "MAR" : MNTH=3  : PRINT MNTH$; : GOTO 2230:REM GO->MONTHCHARTWO 
2060 IF K$ = "A" THEN MNTH$ = "APR" : MNTH=4  : PRINT MNTH$; : GOTO 2230:REM GO->MONTHCHARTWO 
2070 IF K$ = "S" THEN MNTH$ = "SEP" : MNTH=9  : PRINT MNTH$; : GOTO 2230:REM GO->MONTHCHARTWO 
2080 IF K$ = "O" THEN MNTH$ = "OCT" : MNTH=10 : PRINT MNTH$; : GOTO 2230:REM GO->MONTHCHARTWO 
2090 IF K$ = "N" THEN MNTH$ = "NOV" : MNTH=11 : PRINT MNTH$; : GOTO 2230:REM GO->MONTHCHARTWO 
2100 IF K$ = "D" THEN MNTH$ = "DEC" : MNTH=12 : PRINT MNTH$; : GOTO 2230:REM GO->MONTHCHARTWO 
2110 IF K$ = " "             THEN GOTO 2230:REM GO->MONTHCHARTWO 
2120 IF K$ = TB$        THEN GOTO 2610:REM GO->YEARDIGITONE 
2130 IF K$ = RT$ THEN GOTO 2230:REM GO->MONTHCHARTWO 
2140 IF K$ = LT$  THEN GOTO 1800:REM GO->DAYDIGITTWO 
2150 IF K$ = DOWN$ THEN GOSUB 3310:REM GO->MINUTEDIGITONE 
2160 IF K$ = "+"             THEN GOSUB 4110 : PRINT MNTH$; : GOTO 2000:REM GO->INCMONTH MONTHCHARONE 
2170 IF K$ = "-"             THEN GOSUB 4170 : PRINT MNTH$; : GOTO 2000:REM GO->DECMONTH MONTHCHARONE 
2180 IF K$ = DLT$ THEN GOTO 1800:REM GO->DAYDIGITTWO 
2190 GOSUB 4730:REM GO->JUMPKEYS 
2200 GOSUB 1610:REM GO->SOUNDERROR 
2210 GOTO 2000:REM GO->MONTHCHARONE 
2220 REM->MONTHCHARTWO
2230 HTAB 21 : VTAB 9
2240 GET K$
2250 IF K$ = MID$(MNTH$, 2, 1) THEN GOTO 2410:REM GO->MONTHCHARTHREE 
2260 LET FIRST$ = LEFT$(MNTH$, 1)
2270 IF FIRST$ = "A" AND K$ = "P" THEN MNTH$ = "APR" : MNTH=4 : PRINT "PR"; : GOTO 2410:REM GO->MONTHCHARTHREE 
2280 IF FIRST$ = "A" AND K$ = "U" THEN MNTH$ = "AUG" : MNTH=8 : PRINT "UG"; : GOTO 2410:REM GO->MONTHCHARTHREE 
2290 IF K$ = " "             THEN GOTO 2410:REM GO->MONTHCHARTHREE 
2300 IF K$ = TB$        THEN GOTO 2610:REM GO->YEARDIGITONE 
2310 IF K$ = RT$ THEN GOTO 2410:REM GO->MONTHCHARTHREE 
2320 IF K$ = LT$  THEN GOTO 2000:REM GO->MONTHCHARONE 
2330 IF K$ = DOWN$ THEN GOTO 3310:REM GO->MINUTEDIGITONE 
2340 IF K$ = "+"             THEN GOSUB 4110 : PRINT LT$;MNTH$; : GOTO 2230:REM GO->INCMONTH MONTHCHARTWO 
2350 IF K$ = "-"             THEN GOSUB 4170 : PRINT LT$;MNTH$; : GOTO 2230:REM GO->DECMONTH MONTHCHARTWO 
2360 IF K$ = DLT$ THEN GOTO 2000:REM GO->MONTHCHARONE 
2370 GOSUB 4730:REM GO->JUMPKEYS 
2380 GOSUB 1610:REM GO->SOUNDERROR 
2390 GOTO 2230:REM GO->MONTHCHARTWO 
2400 REM->MONTHCHARTHREE
2410 HTAB 22 : VTAB 9
2420 IF K$ = RIGHT$(MNTH$, 1) THEN GOTO 2610:REM GO->YEARDIGITONE 
2430 LET TWO$ = LEFT$(MNTH$, 2)
2440 GET K$
2450 IF TWO$ = "MA" AND K$ = "R" THEN MNTH$ = "MAR" : MNTH=3 : PRINT K$; : GOTO 2610:REM GO->YEARDIGITONE 
2460 IF TWO$ = "MA" AND K$ = "Y" THEN MNTH$ = "MAY" : MNTH=5 : PRINT K$; : GOTO 2610:REM GO->YEARDIGITONE 
2470 IF TWO$ = "JU" AND K$ = "N" THEN MNTH$ = "JUN" : MNTH=6 : PRINT K$; : GOTO 2610:REM GO->YEARDIGITONE 
2480 IF TWO$ = "JU" AND K$ = "L" THEN MNTH$ = "JUL" : MNTH=7 : PRINT K$; : GOTO 2610:REM GO->YEARDIGITONE 
2490 IF K$ = " "             THEN GOTO 2610:REM GO->YEARDIGITONE 
2500 IF K$ = TB$        THEN GOTO 2610:REM GO->YEARDIGITONE 
2510 IF K$ = RT$ THEN GOTO 2610:REM GO->YEARDIGITONE 
2520 IF K$ = LT$  THEN GOTO 2230:REM GO->MONTHCHARTWO 
2530 IF K$ = DOWN$ THEN GOTO 3310:REM GO->MINUTEDIGITONE 
2540 IF K$ = "+"             THEN GOSUB 4110 : PRINT LT$;LT$;MNTH$; : GOTO 2410:REM GO->INCMONTH MONTHCHARTHREE 
2550 IF K$ = "-"             THEN GOSUB 4170 : PRINT LT$;LT$;MNTH$; : GOTO 2410:REM GO->DECMONTH MONTHCHARTHREE 
2560 IF K$ = DLT$ THEN GOTO 2230:REM GO->MONTHCHARTWO 
2570 GOSUB 4730:REM GO->JUMPKEYS 
2580 GOSUB 1610:REM GO->SOUNDERROR 
2590 GOTO 2410:REM GO->MONTHCHARTHREE 
2600 REM->YEARDIGITONE
2610 HTAB 26 : VTAB 9
2620 GET K$
2630 IF "0" <= K$ AND K$ <= "9" THEN PRINT K$; : YEAR$ = K$ + RIGHT$(YEAR$, 1) : GOTO 2760:REM GO->YEARDIGITTWO 
2640 IF K$ = " "             THEN GOTO 2760:REM GO->YEARDIGITTWO 
2650 IF K$ = TB$        THEN GOTO 2960:REM GO->HOURDIGITONE 
2660 IF K$ = RT$ THEN GOTO 2760:REM GO->YEARDIGITTWO 
2670 IF K$ = LT$  THEN GOTO 2410:REM GO->MONTHCHARTHREE 
2680 IF K$ = DOWN$ THEN GOTO 3660:REM GO->MERIDIEM 
2690 IF K$ = "+"             THEN GOSUB 4230 : PRINT YEAR$; : GOTO 2610:REM GO->INCYEAR YEARDIGITONE 
2700 IF K$ = "-"             THEN GOSUB 4300 : PRINT YEAR$; : GOTO 2610:REM GO->DECYEAR YEARDIGITONE 
2710 IF K$ = DLT$ THEN GOTO 2410:REM GO->MONTHCHARTHREE 
2720 GOSUB 4730:REM GO->JUMPKEYS 
2730 GOSUB 1610:REM GO->SOUNDERROR 
2740 GOTO 2610:REM GO->YEARDIGITONE 
2750 REM->YEARDIGITTWO
2760 HTAB 27 : VTAB 9
2770 GET K$
2780 IF K$ < "0" OR "9" < K$ THEN GOTO 2840:REM GO->YEARDIGITTWOKEYS 
2790 LET FIRST$ = LEFT$(YEAR$, 1)
2800 LET TEST$ = FIRST$ + K$
2810 LET TV = VAL(TEST$)
2820 IF 1 <= TV AND TV <= 99 THEN PRINT K$; : YEAR$ = TEST$ : YEAR = TV : GOTO 2960:REM GO->HOURDIGITONE 
2830 REM->YEARDIGITTWOKEYS
2840 IF K$ = " "             THEN GOTO 2960:REM GO->HOURDIGITONE 
2850 IF K$ = TB$        THEN GOTO 2960:REM GO->HOURDIGITONE 
2860 IF K$ = RT$ THEN GOTO 2960:REM GO->HOURDIGITONE 
2870 IF K$ = LT$  THEN GOTO 2610:REM GO->YEARDIGITONE 
2880 IF K$ = DOWN$ THEN GOTO 3660:REM GO->MERIDIEM 
2890 IF K$ = "+"             THEN GOSUB 4230 : PRINT LT$;YEAR$; : GOTO 2760:REM GO->INCYEAR YEARDIGITTWO 
2900 IF K$ = "-"             THEN GOSUB 4300 : PRINT LT$;YEAR$; : GOTO 2760:REM GO->DECYEAR YEARDIGITTWO 
2910 IF K$ = DLT$ THEN GOTO 2610:REM GO->YEARDIGITONE 
2920 GOSUB 4730:REM GO->JUMPKEYS 
2930 GOSUB 1610:REM GO->SOUNDERROR 
2940 GOTO 2760:REM GO->YEARDIGITTWO 
2950 REM->HOURDIGITONE
2960 HTAB 15 : VTAB 14
2970 GET K$
2980 IF "0" <= K$ AND K$ <= "1" THEN PRINT K$; : HOUR$ = K$ + RIGHT$(HOUR$, 1) : GOTO 3110:REM GO->HOURDIGITTWO 
2990 IF K$ = " "             THEN GOTO 3110:REM GO->HOURDIGITTWO 
3000 IF K$ = TB$        THEN GOTO 3310:REM GO->MINUTEDIGITONE 
3010 IF K$ = RT$ THEN GOTO 3110:REM GO->HOURDIGITTWO 
3020 IF K$ = LT$  THEN GOTO 2760:REM GO->YEARDIGITTWO 
3030 IF K$ = UP$    THEN GOTO 1650:REM GO->DAYDIGITONE 
3040 IF K$ = "+"             THEN GOSUB 4370 : PRINT HOUR$; : GOTO 2960:REM GO->INCHOUR HOURDIGITONE 
3050 IF K$ = "-"             THEN GOSUB 4440 : PRINT HOUR$; : GOTO 2960:REM GO->DECHOUR HOURDIGITONE 
3060 IF K$ = DLT$ THEN GOTO 2760:REM GO->YEARDIGITTWO 
3070 GOSUB 4730:REM GO->JUMPKEYS 
3080 GOSUB 1610:REM GO->SOUNDERROR 
3090 GOTO 2960:REM GO->HOURDIGITONE 
3100 REM->HOURDIGITTWO
3110 HTAB 16 : VTAB 14
3120 GET K$
3130 IF K$ < "0" OR "9" < K$ THEN GOTO 3190:REM GO->HOURDIGITTWOKEYS 
3140 LET FIRST$ = LEFT$(HOUR$, 1)
3150 LET TEST$ = FIRST$ + K$
3160 LET TV = VAL(TEST$)
3170 IF 1 <= TV AND TV <= 12 THEN PRINT K$; : HOUR$ = TEST$ : HOUR = TV : GOTO 3310:REM GO->MINUTEDIGITONE 
3180 REM->HOURDIGITTWOKEYS
3190 IF K$ = " "             THEN GOTO 3310:REM GO->MINUTEDIGITONE 
3200 IF K$ = TB$        THEN GOTO 3310:REM GO->MINUTEDIGITONE 
3210 IF K$ = RT$ THEN GOTO 3310:REM GO->MINUTEDIGITONE 
3220 IF K$ = LT$  THEN GOTO 2960:REM GO->HOURDIGITONE 
3230 IF K$ = UP$    THEN GOTO 1650:REM GO->DAYDIGITONE 
3240 IF K$ = "+"             THEN GOSUB 4370 : PRINT LT$;HOUR$; : GOTO 3110:REM GO->INCHOUR HOURDIGITTWO 
3250 IF K$ = "-"             THEN GOSUB 4440 : PRINT LT$;HOUR$; : GOTO 3110:REM GO->DECHOUR HOURDIGITTWO 
3260 IF K$ = DLT$ THEN GOTO 2960:REM GO->HOURDIGITONE 
3270 GOSUB 4730:REM GO->JUMPKEYS 
3280 GOSUB 1610:REM GO->SOUNDERROR 
3290 GOTO 3110:REM GO->HOURDIGITTWO 
3300 REM->MINUTEDIGITONE
3310 HTAB 20 : VTAB 14
3320 GET K$
3330 IF "0" <= K$ AND K$ <= "5" THEN PRINT K$; : MINUTE$ = K$ + RIGHT$(MINUTE$, 1) : GOTO 3460:REM GO->MINUTEDIGITTWO 
3340 IF K$ = " "             THEN GOTO 3460:REM GO->MINUTEDIGITTWO 
3350 IF K$ = TB$        THEN GOTO 3660:REM GO->MERIDIEM 
3360 IF K$ = RT$ THEN GOTO 3460:REM GO->MINUTEDIGITTWO 
3370 IF K$ = LT$  THEN GOTO 3110:REM GO->HOURDIGITTWO 
3380 IF K$ = UP$    THEN GOTO 2000:REM GO->MONTHCHARONE 
3390 IF K$ = "+"             THEN GOSUB 4510 : PRINT MINUTE$; : GOTO 3310:REM GO->INCMINUTE MINUTEDIGITONE 
3400 IF K$ = "-"             THEN GOSUB 4580 : PRINT MINUTE$; : GOTO 3310:REM GO->DECMINUTE MINUTEDIGITONE 
3410 IF K$ = DLT$ THEN GOTO 3110:REM GO->HOURDIGITTWO 
3420 GOSUB 4730:REM GO->JUMPKEYS 
3430 GOSUB 1610:REM GO->SOUNDERROR 
3440 GOTO 3310:REM GO->MINUTEDIGITONE 
3450 REM->MINUTEDIGITTWO
3460 HTAB 21 : VTAB 14
3470 GET K$
3480 IF K$ < "0" OR "9" < K$ THEN GOTO 3540:REM GO->MINUTEDIGITTWOKEYS 
3490 LET FIRST$ = LEFT$(MINUTE$, 1)
3500 LET TEST$ = FIRST$ + K$
3510 LET TV = VAL(TEST$)
3520 IF 0 <= TV AND TV <= 59 THEN PRINT K$; : MINUTE$ = TEST$ : MINUTE = TV : GOTO 3660:REM GO->MERIDIEM 
3530 REM->MINUTEDIGITTWOKEYS
3540 IF K$ = " "             THEN GOTO 3660:REM GO->MERIDIEM 
3550 IF K$ = TB$        THEN GOTO 3660:REM GO->MERIDIEM 
3560 IF K$ = RT$ THEN GOTO 3660:REM GO->MERIDIEM 
3570 IF K$ = LT$  THEN GOTO 3310:REM GO->MINUTEDIGITONE 
3580 IF K$ = UP$    THEN GOTO 2000:REM GO->MONTHCHARONE 
3590 IF K$ = "+"             THEN GOSUB 4510 : PRINT LT$;MINUTE$; : GOTO 3460:REM GO->INCMINUTE MINUTEDIGITTWO 
3600 IF K$ = "-"             THEN GOSUB 4580 : PRINT LT$;MINUTE$; : GOTO 3460:REM GO->DECMINUTE MINUTEDIGITTWO 
3610 IF K$ = DLT$ THEN GOTO 3310:REM GO->MINUTEDIGITONE 
3620 GOSUB 4730:REM GO->JUMPKEYS 
3630 GOSUB 1610:REM GO->SOUNDERROR 
3640 GOTO 3460:REM GO->MINUTEDIGITTWO 
3650 REM->MERIDIEM
3660 HTAB 24 : VTAB 14
3670 GET K$
3680 IF K$ = "A" OR K$ = "P" THEN PRINT K$; : AMPM$ = K$ : GOTO 1650:REM GO->DAYDIGITONE 
3690 IF K$ = " "             THEN GOTO 1650:REM GO->DAYDIGITONE 
3700 IF K$ = TB$        THEN GOTO 1650:REM GO->DAYDIGITONE 
3710 IF K$ = RT$ THEN GOTO 1650:REM GO->DAYDIGITONE 
3720 IF K$ = LT$  THEN GOTO 3460:REM GO->MINUTEDIGITTWO 
3730 IF K$ = UP$    THEN GOTO 2610:REM GO->YEARDIGITONE 
3740 IF K$ = "+"             THEN GOSUB 4650 : PRINT AMPM$; : GOTO 3660:REM GO->INCMERIDIEM MERIDIEM 
3750 IF K$ = "-"             THEN GOSUB 4690 : PRINT AMPM$; : GOTO 3660:REM GO->DECMERIDIEM MERIDIEM 
3760 IF K$ = DLT$ THEN GOTO 3460:REM GO->MINUTEDIGITTWO 
3770 GOSUB 4730:REM GO->JUMPKEYS 
3780 GOSUB 1610:REM GO->SOUNDERROR 
3790 GOTO 3660:REM GO->MERIDIEM 
3800 REM->PRINTDATE
3810 GOSUB 3910:REM GO->PADYEAR 
3820 PRINT YEAR$;"-";
3830 IF MNTH < 10 THEN PRINT "0";
3840 PRINT MNTH;"-";
3850 IF DAY < 10 THEN PRINT "0";
3860 PRINT DAY;" ";HOUR;":";
3870 IF MINUTE < 10 THEN PRINT "0";
3880 PRINT MINUTE;" ";AMPM$;"M"
3890 RETURN 
3900 REM->PADYEAR
3910 IF YEAR = 0 THEN YEAR$ = "0000": RETURN 
3920 LET YEAR$ = STR$(2000 + YEAR)
3930 RETURN 
3940 REM->INCDAY
3950 LET DAY = VAL(DAY$)
3960 LET DAY = DAY + 1
3970 GOSUB 1150:REM GO->DECODEMONTH 
3980 IF DAY > MDAYS(MNTH) THEN DAY = 1
3990 LET DAY$ = STR$(DAY)
4000 IF DAY < 10 THEN DAY$ = "0" + DAY$
4010 RETURN
4020 REM->DECDAY
4030 LET DAY = VAL(DAY$)
4040 LET DAY = DAY - 1
4050 GOSUB 1150:REM GO->DECODEMONTH 
4060 IF DAY <= 0 THEN DAY = MDAYS(MNTH)
4070 LET DAY$ = STR$(DAY)
4080 IF DAY < 10 THEN DAY$ = "0" + DAY$
4090 RETURN
4100 REM->INCMONTH
4110 GOSUB 1150:REM GO->DECODEMONTH 
4120 LET MNTH = MNTH - 1
4130 IF MNTH < 1 THEN MNTH = 12
4140 GOSUB 1040:REM GO->FORMATDATEANDTIME 
4150 RETURN
4160 REM->DECMONTH
4170 GOSUB 1150:REM GO->DECODEMONTH 
4180 LET MNTH = MNTH + 1
4190 IF MNTH > 12 THEN MNTH = 1
4200 GOSUB 1040:REM GO->FORMATDATEANDTIME 
4210 RETURN
4220 REM->INCYEAR
4230 LET YEAR = VAL(YEAR$)
4240 LET YEAR = YEAR + 1
4250 IF YEAR > 99 THEN YEAR = 0
4260 LET YEAR$ = STR$(YEAR)
4270 IF YEAR < 10 THEN YEAR$ = "0" + YEAR$
4280 RETURN
4290 REM->DECYEAR
4300 LET YEAR = VAL(YEAR$)
4310 LET YEAR = YEAR - 1
4320 IF YEAR < 0  THEN YEAR = 99
4330 LET YEAR$ = STR$(YEAR)
4340 IF YEAR < 10 THEN YEAR$ = "0" + YEAR$
4350 RETURN
4360 REM->INCHOUR
4370 LET HOUR = VAL(HOUR$)
4380 LET HOUR = HOUR + 1
4390 IF HOUR > 12 THEN HOUR = 1
4400 LET HOUR$ = STR$(HOUR)
4410 IF HOUR < 10 THEN HOUR$ = "0" + HOUR$
4420 RETURN
4430 REM->DECHOUR
4440 LET HOUR = VAL(HOUR$)
4450 LET HOUR = HOUR - 1
4460 IF HOUR < 1 THEN HOUR = 12
4470 LET HOUR$ = STR$(HOUR)
4480 IF HOUR < 10 THEN HOUR$ = "0" + HOUR$
4490 RETURN
4500 REM->INCMINUTE
4510 LET MINUTE = VAL(MINUTE$)
4520 LET MINUTE = MINUTE + 1
4530 IF MINUTE > 59 THEN MINUTE = 0
4540 LET MINUTE$ = STR$(MINUTE)
4550 IF MINUTE < 10 THEN MINUTE$ = "0" + MINUTE$
4560 RETURN
4570 REM->DECMINUTE
4580 LET MINUTE = VAL(MINUTE$)
4590 LET MINUTE = MINUTE - 1
4600 IF MINUTE < 0 THEN MINUTE = 59
4610 LET MINUTE$ = STR$(MINUTE)
4620 IF MINUTE < 10 THEN MINUTE$ = "0" + MINUTE$
4630 RETURN
4640 REM->INCMERIDIEM
4650 IF AMPM$ = "A" THEN AMPM$ = "P" : RETURN
4660 IF AMPM$ = "P" THEN AMPM$ = "A"
4670 RETURN
4680 REM->DECMERIDIEM
4690 IF AMPM$ = "A" THEN AMPM$ = "P" : RETURN
4700 IF AMPM$ = "P" THEN AMPM$ = "A"
4710 RETURN
4720 REM->JUMPKEYS
4730 IF K$ = ESC$ THEN POP : RETURN
4740 IF K$ = RET$ THEN POP : RETURN
4750 IF PEEK(49249) <= 127 THEN RETURN
4760 IF K$ = "D" THEN POP : GOTO 1650:REM GO->DAYDIGITONE 
4770 IF K$ = "M" THEN POP : GOTO 2000:REM GO->MONTHCHARONE 
4780 IF K$ = "Y" THEN POP : GOTO 2610:REM GO->YEARDIGITONE 
4790 IF K$ = "H" THEN POP : GOTO 2960:REM GO->HOURDIGITONE 
4800 IF K$ = "N" THEN POP : GOTO 3310:REM GO->MINUTEDIGITONE 
4810 IF K$ = "R" THEN POP : GOTO 3660:REM GO->MERIDIEM 
4820 RETURN